(function(e){function t(t){for(var n,a,i=t[0],c=t[1],d=t[2],u=0,g=[];u<i.length;u++)a=i[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&g.push(o[a][0]),o[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);l&&l(t);while(g.length)g.shift()();return r.push.apply(r,d||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],n=!0,i=1;i<s.length;i++){var c=s[i];0!==o[c]&&(n=!1)}n&&(r.splice(t--,1),e=a(a.s=s[0]))}return e}var n={},o={app:0},r=[];function a(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=n,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(s,n,function(t){return e[t]}.bind(null,n));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var d=0;d<i.length;d++)t(i[d]);var l=c;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},4678:function(e,t,s){var n={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function o(e){var t=r(e);return s(t)}function r(e){if(!s.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=r,e.exports=o,o.id="4678"},"56d7":function(e,t,s){"use strict";s.r(t);s("96cf");var n=s("3b8d"),o=(s("cadf"),s("551c"),s("f751"),s("097d"),s("2b0e")),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[e.$store.getters.getOs.isAlipay||"development"===e.env?s("div",[s("router-view"),s("van-tabbar",{attrs:{route:!0}},[s("van-tabbar-item",{attrs:{name:"/",icon:"home-o",to:"/",dot:void 0!==e.$store.getters.getOrder}},[e._v("挂号\n      ")]),s("van-tabbar-item",{attrs:{name:"/user",icon:"user-o",to:"/user"}},[e._v("用户须知")])],1)],1):e._e(),e.$store.getters.getOs.isAlipay||"production"!==e.env?e._e():s("div",[s("h2",{staticStyle:{margin:"30px"}},[e._v("请使用支付宝扫码的方式打开本工具！")]),s("van-button",{attrs:{type:"info"},on:{click:e.openAliScan}},[e._v("帮我从支付宝打开")])],1)])},a=[],i=(s("c5f6"),s("c1df")),c={name:"user",data:function(){return{env:"production"}},sockets:{connect:function(){this.autoLogin()},login:function(e){if(this.$store.dispatch("setLoginLoading",!1),"string"===typeof e)return this.$toast.fail(e),localStorage.removeItem("username"),void localStorage.removeItem("password");void 0!==e.lastUseTime&&(e.nextUseTime=i(this.addDays(new Date(e.lastUseTime),30)).format("YYYY-MM-DD HH:mm:ss")),this.$store.dispatch("setUser",e),localStorage.setItem("username",e.username),localStorage.setItem("password",e.password),this.init()},loadDepartments:function(e){"string"!==typeof e?this.$store.dispatch("setDepartments",e):this.$toast.fail(e)},loadDoctors:function(e){"string"!==typeof e?this.$store.dispatch("setDoctors",e):this.$toast.fail(e)},loadSpec:function(e){"string"!==typeof e?this.$store.dispatch("setSpecs",e):this.$toast.fail(e)},loadAppUserInfo:function(e){"string"!==typeof e?this.$store.dispatch("setUserInfo",e):this.$toast.fail(e)},loadMedCards:function(e){"string"!==typeof e?this.$store.dispatch("setMedCards",e):this.$toast.fail(e)},loadItems:function(e){if("string"!==typeof e){for(var t in e)if(e.hasOwnProperty(t)){var s=0,n=void 0;for(var o in e[t].regTokens)e[t].regTokens.hasOwnProperty(o)&&(s+=e[t].regTokens[o].validNum,n=e[t].regTokens[o].medFee);e[t].medFee=n,e[t].validNum=s}this.$store.dispatch("setItems",e)}else this.$toast.fail(e)},loginExpired:function(){this.$store.dispatch("setUser",{})},orderException:function(e){console.log(this.$store.getters.getOrder),"操作频繁请稍候再试"===e&&void 0!==this.$store.getters.getOrder||this.$toast.fail({message:e})},orderUpdate:function(e){this.$store.dispatch("setOrder",e),3===e.state&&this.pay(e)},orderInfo:function(e){this.$toast.success({message:e})}},methods:{addDays:function(e,t){var s=new Date(Number(e));return s.setDate(e.getDate()+t),s},autoLogin:function(){if(void 0===this.$store.getters.getUser.userid&&null!==localStorage.getItem("username")&&null!==localStorage.getItem("password")){var e=localStorage.getItem("username"),t=localStorage.getItem("password");this.$store.dispatch("setLoginLoading",!0),this.$socket.emit("login",{username:e,password:t})}},init:function(){0!==this.$store.getters.getInitedCount&&(this.$store.dispatch("resetInitedCount"),this.loadDepartments(),this.loadDoctors(),this.loadSpec(),this.loadAppUserInfo(),this.loadMedCards())},loadDepartments:function(){this.$socket.emit("loadDepartments")},loadDoctors:function(){this.$socket.emit("loadDoctors")},loadSpec:function(){this.$socket.emit("loadSpec")},loadAppUserInfo:function(){this.$socket.emit("loadAppUserInfo")},loadMedCards:function(){this.$socket.emit("loadMedCards")},openAliScan:function(){this.$store.getters.getOs.isPhone?window.open("alipayqr://platformapi/startapp?saId=10000007&clientVersion=3.7.0.0718&qrcode="+window.location.href):this.$dialog.alert({message:"需要您在手机上打开本工具，才能帮你打开支付宝哦^.^",confirmButtonText:"我知道了"})},pay:function(e){var t=this;window.ap.tradePay({orderStr:e.aliPayParams.orderStr},(function(s){"9000"===s.resultCode?(e.state=4,t.$store.dispatch("setOrder",e),t.$dialog.confirm({title:"恭喜",message:"您已经挂号成功，本工具仅靠个人业余维护，租赁云服务器也有不小的花费，如果您不介意的话，能否慷慨解囊打赏一下作者，最后，衷心地地祝愿您的孩子早日康复！",confirmButtonText:"打赏",cancelButtonText:"残忍拒绝"}).then((function(){t.payAuthor()})).catch((function(){}))):t.$dialog.confirm({title:"提醒",message:"请尽量在呼出的收银台付款，放号高峰期客户端登录可能会失败，付款过慢可能会导致挂号失败！",confirmButtonText:"呼出收银台",cancelButtonText:"自行付款"}).then((function(){t.pay(e)})).catch((function(){}))}))},payAuthor:function(){var e="alipayqr://platformapi/startapp?saId=10000007&clientVersion=3.7.0.0718&qrcode="+encodeURI("https://qr.alipay.com/fkx00506jxkfixll6sbpm30")+"%3F_s%3Dweb-other&_t="+(new Date).getTime();window.open(e)}}},d=c,l=(s("5c0b"),s("2877")),u=Object(l["a"])(d,r,a,!1,null,null,null),g=u.exports,m=s("8c4f"),f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:void 0===e.$store.getters.getOrder,expression:"$store.getters.getOrder === undefined"}]},[s("div",{directives:[{name:"show",rawName:"v-show",value:void 0===e.$store.getters.getUser.userid,expression:"$store.getters.getUser.userid === undefined"}]},[s("van-cell-group",{attrs:{title:"登录"}},[s("van-field",{attrs:{clearable:"",readonly:e.$store.getters.getLoginLoading,label:"账号","right-icon":"question-o",placeholder:"请输入官方 App 账号"},on:{"click-right-icon":function(t){return e.$toast("本工具需要使用您的官方 APP 账号，但请放心，账号和密码只会保存在本机")}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),s("van-field",{attrs:{readonly:e.$store.getters.getLoginLoading,type:"password",label:"密码",placeholder:"请输入官方 App 密码"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),s("van-button",{attrs:{type:"info",loading:e.$store.getters.getLoginLoading,"loading-text":"登录中...",disabled:0===e.username.length||0===e.password.length},on:{click:e.login}},[e._v("登录\n      ")])],1),void 0!==e.$store.getters.getUser.userid?s("van-skeleton",{attrs:{row:20,loading:e.loading}},[s("van-cell-group",{attrs:{title:"查号选项"}},[s("van-cell",{attrs:{title:"科室选择",value:0===e.$store.getters.getDepartments.length?"加载中...":"当前选择: "+e.$store.getters.getDepartments[this.$store.getters.getDepartmentIndex].deptName,"is-link":0!==e.$store.getters.getDepartments.length},on:{click:function(t){e.showDepartmentPicker=!0}}}),s("van-popup",{attrs:{position:"bottom"},model:{value:e.showDepartmentPicker,callback:function(t){e.showDepartmentPicker=t},expression:"showDepartmentPicker"}},[s("van-picker",{attrs:{"show-toolbar":"","value-key":"deptName","default-index":this.$store.getters.getDepartmentIndex,columns:e.$store.getters.getDepartments},on:{cancel:function(t){e.showDepartmentPicker=!1},confirm:e.changeDepartment}})],1),s("van-cell",{attrs:{title:"门诊类型",value:"当前选择: "+e.outpatientType[e.$store.getters.getOutpatientTypeIndex].type,"is-link":""},on:{click:function(t){e.showTypePicker=!0}}}),s("van-popup",{attrs:{position:"bottom"},model:{value:e.showTypePicker,callback:function(t){e.showTypePicker=t},expression:"showTypePicker"}},[s("van-picker",{attrs:{"show-toolbar":"","value-key":"type","default-index":e.$store.getters.getOutpatientTypeIndex,columns:e.outpatientType},on:{cancel:function(t){e.showTypePicker=!1},confirm:e.changeOutpatientType}})],1),s("van-cell",{attrs:{title:"日期选择",value:"当前选择: "+e.selectedDateStr,"is-link":""},on:{click:function(t){e.showDatePicker=!0}}}),s("van-popup",{attrs:{position:"bottom"},model:{value:e.showDatePicker,callback:function(t){e.showDatePicker=t},expression:"showDatePicker"}},[s("van-datetime-picker",{attrs:{type:"date","min-date":e.$store.getters.getToday,formatter:e.datePickerFormat,"max-date":e.endDay},on:{cancel:function(t){e.showDatePicker=!1},confirm:e.changeDate},model:{value:e.datePickerDate,callback:function(t){e.datePickerDate=t},expression:"datePickerDate"}})],1)],1),s("van-cell-group",{attrs:{title:"可选号源"}},[s("van-list",{attrs:{finished:!e.loadingItems},model:{value:e.loadingItems,callback:function(t){e.loadingItems=t},expression:"loadingItems"}},[e._l(e.$store.getters.getItems,(function(t){return s("van-cell",{directives:[{name:"show",rawName:"v-show",value:!e.loadingItems,expression:"!loadingItems"}],key:t.specCode,attrs:{title:t.specName+"（余号:"+t.validNum+"| ¥"+t.medFee+"）",value:"开始预约","is-link":""},on:{click:function(s){return e.selectRegToken(t)}}})})),s("h3",{directives:[{name:"show",rawName:"v-show",value:!e.loadingItems&&0===e.$store.getters.getItems.length,expression:"!loadingItems && $store.getters.getItems.length === 0"}]},[e._v("\n            当天无可挂号源\n          ")]),s("van-popup",{attrs:{position:"bottom"},model:{value:e.showRegTokenSelector,callback:function(t){e.showRegTokenSelector=t},expression:"showRegTokenSelector"}},[s("van-picker",{attrs:{"show-toolbar":"",title:"选择预约时间段","value-key":"schedulingName",columns:e.regTokens,"confirm-button-text":"下一步"},on:{cancel:function(t){e.showRegTokenSelector=!1},confirm:e.doSelectRegToken}})],1),s("van-popup",{attrs:{position:"bottom"},model:{value:e.showMedCardSelector,callback:function(t){e.showMedCardSelector=t},expression:"showMedCardSelector"}},[s("van-picker",{attrs:{"show-toolbar":"",title:"选择就诊卡","value-key":"name",columns:e.$store.getters.getMedCards,"confirm-button-text":"下一步"},on:{cancel:function(t){e.showMedCardSelector=!1},confirm:e.doSelectMedCard}})],1),s("van-dialog",{attrs:{title:"请确认预约任务",showCancelButton:void 0===e.submittingTaskCallback,"confirm-button-text":"确认无误","cancel-button-text":"重新选择",beforeClose:e.confirmTask,"show-cancel-button":""},model:{value:e.showTaskConfirm,callback:function(t){e.showTaskConfirm=t},expression:"showTaskConfirm"}},[s("van-cell",{attrs:{title:"科室",value:e.selectedItem.deptName}}),s("van-cell",{attrs:{title:"门诊类型",value:e.outpatientType[e.$store.getters.getOutpatientTypeIndex].type}}),s("van-cell",{attrs:{title:"日期",value:e.selectedDateStr}}),s("van-cell",{attrs:{title:"号源",value:e.selectedItem.specName}}),s("van-cell",{attrs:{title:"时间",value:e.selectedRegTokens.schedulingName}}),s("van-cell",{attrs:{title:"就诊卡",value:e.selectedMedCard.name}})],1)],2)],1)],1):e._e()],1),void 0!==e.$store.getters.getOrder?s("div",[s("van-cell-group",{attrs:{title:"挂号中"}},[s("van-cell",{attrs:{title:"科室",value:e.$store.getters.getOrder.deptName}}),s("van-cell",{attrs:{title:"门诊类型",value:e.outpatientType[e.$store.getters.getOutpatientTypeIndex].type}}),s("van-cell",{attrs:{title:"日期",value:e.$store.getters.getOrder.aptDateStr}}),s("van-cell",{attrs:{title:"号源",value:e.$store.getters.getOrder.regName}}),s("van-cell",{attrs:{title:"时间",value:e.$store.getters.getOrder.time}}),s("van-cell",{attrs:{title:"就诊卡",value:e.$store.getters.getOrder.medCardName}}),s("van-steps",{attrs:{active:e.$store.getters.getOrder.state,direction:"vertical"}},[s("van-step",[e._v("提交任务 "+e._s(e.$store.getters.getOrder.submitTime))]),s("van-step",[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.$store.getters.getOrder.alreadyShowAptTooLateWarning,expression:"!$store.getters.getOrder.alreadyShowAptTooLateWarning"}]},[e._v("\n            查询余票 "+e._s("查票:"+e.$store.getters.getOrder.queryTime+"|余票:"+e.$store.getters.getOrder.validNum+"|下单:"+e.$store.getters.getOrder.tryOrderTime)+"\n          ")]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.$store.getters.getOrder.alreadyShowAptTooLateWarning,expression:"$store.getters.getOrder.alreadyShowAptTooLateWarning"}]},[e._v("\n            "+e._s("将于 "+e.$store.getters.getOrder.aptDate+" 日 0 点开始查询余票")+"\n          ")])]),s("van-step",[e._v("下单成功")]),s("van-step",[e._v("拉取付款码")]),s("van-step",[e._v("付款成功")])],1),s("van-button",{directives:[{name:"show",rawName:"v-show",value:e.$store.getters.getOrder.state<3,expression:"$store.getters.getOrder.state < 3"}],attrs:{type:"danger"},on:{click:e.cancelTask}},[e._v("取消预约")]),s("van-button",{directives:[{name:"show",rawName:"v-show",value:3==e.$store.getters.getOrder.state,expression:"$store.getters.getOrder.state == 3"}],attrs:{type:"info"},on:{click:e.alreadyPay}},[e._v("已自行付款")]),s("van-button",{directives:[{name:"show",rawName:"v-show",value:4==e.$store.getters.getOrder.state,expression:"$store.getters.getOrder.state == 4"}],attrs:{type:"primary"},on:{click:e.deleteOrder}},[e._v("恭喜！挂号成功！")])],1)],1):e._e()])},h=[],p=(s("7f7f"),s("ac6a"),s("8615"),[{type:"普通门诊",regLevel:0},{type:"特需专家",regLevel:1}]),v=s("c1df"),k={name:"home",data:function(){return{username:"",password:"",showDepartmentPicker:!1,outpatientType:p,showTypePicker:!1,days:[this.$store.getters.getToday,this.addDays(this.$store.getters.getToday,1),this.addDays(this.$store.getters.getToday,2),this.addDays(this.$store.getters.getToday,3),this.addDays(this.$store.getters.getToday,4),this.addDays(this.$store.getters.getToday,5),this.addDays(this.$store.getters.getToday,6),this.addDays(this.$store.getters.getToday,7)],endDay:this.addDays(this.$store.getters.getToday,7),datePickerDate:this.$store.getters.getToday,showDatePicker:!1,loadingItems:!1,showRegTokenSelector:!1,selectedItem:{},regTokens:[],selectedRegTokens:{},showMedCardSelector:!1,selectedMedCard:{},showTaskConfirm:!1,submittingTaskCallback:void 0,taskRunning:!1}},sockets:{loadItems:function(e){this.loadingItems=!1},submitTask:function(e){this.submittingTaskCallback(),this.showTaskConfirm=!1,"string"!==typeof e?this.$store.dispatch("setOrder",e):this.$toast.fail(e)},cancelTask:function(e){"string"!==typeof e?(this.$toast.success("已取消任务"),this.$store.dispatch("setOrder",void 0)):this.$toast.fail(e)}},computed:{loading:function(){return 0!==this.$store.getters.getInitedCount||(this.$store.getters.getLoadedItems||this.loadItems(),!1)},selectedDateStr:function(){return this.$store.getters.getSelectedDate+this.getDayStr(v(this.$store.getters.getSelectedDate).day())}},methods:{addDays:function(e,t){var s=new Date(Number(e));return s.setDate(e.getDate()+t),s},changeDepartment:function(e,t){this.$store.dispatch("setDepartmentIndex",t),this.showDepartmentPicker=!1,this.loadItems()},changeOutpatientType:function(e,t){this.$store.dispatch("setOutpatientTypeIndex",t),this.showTypePicker=!1,this.loadItems()},datePickerFormat:function(e,t){if("day"===e){for(var s in this.days)if(this.days.hasOwnProperty(s)&&v(this.days[s]).format("DD")===t)return t+this.getDayStr(v(this.days[s]).day());return t}return t},getDayStr:function(e){switch(e){case 1:return"(周一)";case 2:return"(周二)";case 3:return"(周三)";case 4:return"(周四)";case 5:return"(周五)";case 6:return"(周六)";case 0:return"(周天)"}},changeDate:function(){this.$store.dispatch("setSelectedDate",v(this.datePickerDate).format("YYYY-MM-DD")),this.showDatePicker=!1,this.loadItems()},login:function(){this.$store.dispatch("setLoginLoading",!0),this.$socket.emit("login",{username:this.username,password:this.password})},loadItems:function(){this.loadingItems=!0,this.$socket.emit("loadItems",{date:this.$store.getters.getSelectedDate,department:this.$store.getters.getDepartments[this.$store.getters.getDepartmentIndex].deptId,regLevel:this.outpatientType[this.$store.getters.getOutpatientTypeIndex].regLevel})},selectRegToken:function(e){if(this.selectedItem=JSON.parse(JSON.stringify(e)),Object.values(e.regTokens).length>1){var t=Object.values(e.regTokens);for(var s in this.regTokens=[{regToken:[],schedulingName:"全天（按余号数量优先）"}],t){var n=JSON.parse(JSON.stringify(t[s]));n.regToken=[n.regToken],n.schedulingName=n.schedulingName+"（余号:"+n.validNum+"| ¥"+n.medFee+"）",this.regTokens.push(n),this.regTokens[0].regToken.push(n.regToken[0])}}else{var o=JSON.parse(JSON.stringify(Object.values(e.regTokens)[0]));this.regTokens=[o],this.regTokens[0].regToken=[o.regToken],this.regTokens[0].schedulingName=o.schedulingName+"（余号:"+o.validNum+"| ¥"+o.medFee+"）"}this.showRegTokenSelector=!0},doSelectRegToken:function(e){this.showRegTokenSelector=!1,this.selectedRegTokens=JSON.parse(JSON.stringify(e)),this.$store.getters.getUser.leftTime>0||void 0===this.$store.getters.getUser.lastUseTime||(new Date).getTime()>this.addDays(new Date(this.$store.getters.getUser.lastUseTime),30).getTime()?this.$store.getters.getMedCards.length>0?void 0!==this.$store.getters.getUser.bindQq?this.showMedCardSelector=!0:this.$dialog.alert({message:"您的账号尚未绑定 QQ，请联系管理员进行绑定",confirmButtonText:"我知道了"}):this.$dialog.alert({message:"您的账号尚未绑定就诊卡，请先在官方 APP 中绑定就诊卡后，再回到本工具中进行挂号^.^",confirmButtonText:"我知道了"}):this.$dialog.alert({message:"您的使用机会已耗尽，下次使用时间为 "+v(this.addDays(new Date(this.$store.getters.getUser.lastUseTime),30)).format("YYYY-MM-DD HH:mm:ss")+", 如果您短期内急需为孩子多次挂号，请联系管理员^.^",confirmButtonText:"我知道了"})},doSelectMedCard:function(e){this.selectedMedCard=e,this.showMedCardSelector=!1,this.doConfirmTask()},doConfirmTask:function(){this.submittingTaskCallback=void 0,this.showTaskConfirm=!0},confirmTask:function(e,t){"confirm"===e?(this.submittingTaskCallback=t,this.$socket.emit("submitTask",{userId:this.$store.getters.getUser.userid,medCardId:this.selectedMedCard.id,miBind:this.selectedMedCard.miBind,medCardName:this.selectedMedCard.name,regLevel:this.outpatientType[this.$store.getters.getOutpatientTypeIndex].regLevel,aptDate:this.$store.getters.getSelectedDate,aptDateStr:this.$store.getters.getSelectedDate+this.getDayStr(v(this.$store.getters.getSelectedDate).day()),deptName:this.selectedItem.deptName,deptId:this.selectedItem.deptId,regName:this.selectedItem.specName,regTokens:this.selectedRegTokens.regToken,time:this.selectedRegTokens.schedulingName,submitTime:v(new Date).format("YYYY-MM-DD HH:mm:ss"),username:this.$store.getters.getUser.username})):(this.showTaskConfirm=!1,t())},cancelTask:function(){var e=this;this.$dialog.confirm({title:"提醒",message:"您确认要取消预约吗？"}).then((function(){e.$socket.emit("cancelTask")})).catch((function(){}))},alreadyPay:function(){var e=this;this.$dialog.confirm({title:"提醒",message:"您确认已经在官方 App 中付款了么？"}).then((function(){var t=JSON.parse(JSON.stringify(e.$store.getters.getOrder));t.state=4,e.$store.dispatch("setOrder",t)})).catch((function(){}))},deleteOrder:function(){var e=this;this.$dialog.confirm({title:"恭喜",message:"您已经挂号成功，本工具仅靠个人业余维护，租赁云服务器也有不小的花费，如果您不介意的话，能否慷慨解囊打赏一下作者，最后，衷心地地祝愿您的孩子早日康复！",confirmButtonText:"打赏一下",cancelButtonText:"残忍拒绝"}).then((function(){e.$store.dispatch("setOrder",void 0),e.payAuthor()})).catch((function(){e.$store.dispatch("setOrder",void 0)}))},payAuthor:function(){var e="alipayqr://platformapi/startapp?saId=10000007&clientVersion=3.7.0.0718&qrcode="+encodeURI("https://qr.alipay.com/fkx00506jxkfixll6sbpm30")+"%3F_s%3Dweb-other&_t="+(new Date).getTime();window.open(e)}}},b=k,y=Object(l["a"])(b,f,h,!1,null,"3be09ab1",null),w=y.exports,T=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",[s("van-cell-group",{attrs:{title:"用户信息"}},[s("van-cell",{attrs:{title:"账号",value:void 0===e.$store.getters.getUser.username?"请先登录":e.$store.getters.getUser.username,"is-link":""},on:{click:e.clickAccount}}),s("van-action-sheet",{attrs:{actions:e.accountActions,"cancel-text":"取消"},on:{cancel:function(t){e.showAccountAction=!1},select:e.selectAccountAction},model:{value:e.showAccountAction,callback:function(t){e.showAccountAction=t},expression:"showAccountAction"}}),s("van-cell",{attrs:{title:"绑定 QQ","is-link":"",value:void 0===e.$store.getters.getUser.username?"请先登录":void 0===e.$store.getters.getUser.bindQq?"尚未绑定":e.$store.getters.getUser.bindQq},on:{click:e.clickBindQq}}),s("van-cell",{attrs:{title:"剩余试用次数",value:void 0===e.$store.getters.getUser.username?"请先登录":e.$store.getters.getUser.leftTime,"is-link":""},on:{click:e.clickLeftTime}}),s("van-cell",{attrs:{title:"下次可用日期",value:void 0===e.$store.getters.getUser.username?"请先登录":void 0===e.$store.getters.getUser.nextUseTime?"随时可用":e.$store.getters.getUser.nextUseTime,"is-link":""},on:{click:e.clickLastUseTime}})],1)],1),s("div",[s("van-cell-group",{attrs:{title:"关于"}},[s("van-cell",{attrs:{title:"常见问题","is-link":""},on:{click:function(t){e.showQuestionAction=!0}}}),s("van-action-sheet",{attrs:{actions:e.questions,"cancel-text":"取消"},on:{cancel:function(t){e.showQuestionAction=!1},select:e.selectQuestionAction},model:{value:e.showQuestionAction,callback:function(t){e.showQuestionAction=t},expression:"showQuestionAction"}}),s("van-cell",{attrs:{title:"打赏作者","is-link":""},on:{click:e.payAuthor}})],1)],1)])},$=[],j=[{name:"注销账号"}],D=[{name:"功能介绍",answer:"本小程序能够帮助您快速完成抢号流程，增加抢号成功率，但是并不保证一定能抢到。它会自动查询余号，一旦发现余号会自动帮您下单，并且快速呼出支付宝收银台，之后需要您手动验证支付，值得一提的是：如果您支付的太慢，即便下单成功也有可能挂号失败，作者就有这样的惨痛经历！"},{name:"增加使用次数",answer:'如果您的孩子在 30 天内急需多次挂号，可以通过"用户须知->关于->常见问题->联系作者"的方式找到作者，作者可能会酌情增加您的使用机会，前提是您要能证明自己不是黄牛！'},{name:"院方投诉",answer:'本工具的设计初衷是帮助用户对抗黄牛，它只会自动重复挂号流程，而且也有一些限制（每 30 天才可使用一次）来防止黄牛恶意试用本小程序。但是，如果院方觉得本小程序造成了恶劣影响，作者十分愿意配合院方销毁本工具，院方可以通过"用户须知->关于->常见问题->联系作者"的方式找到作者'},{name:"联系作者",answer:"如需联系作者请联系 QQ 群管理员"}],I={name:"user",data:function(){return{accountActions:j,showAccountAction:!1,questions:D,showQuestionAction:!1}},methods:{checkGoToHome:function(){return void 0!==this.$store.getters.getUser.username||(this.$router.push("/"),!1)},clickAccount:function(){this.checkGoToHome()&&(this.showAccountAction=!0)},selectAccountAction:function(e,t){0===t&&(this.$store.dispatch("setUser",{}),this.$store.dispatch("setUserInfo",{}),this.$store.dispatch("setMedCards",{}),localStorage.removeItem("username"),localStorage.removeItem("password"),this.$router.push("/")),this.showAccountAction=!1},clickBindQq:function(){this.checkGoToHome()&&this.$dialog.alert({message:"为防止黄牛恶意使用本工具，每个账号需要绑定 QQ 号后才可以使用，如有需要，请联系管理员进行绑定",confirmButtonText:"我知道了"})},clickLeftTime:function(){this.checkGoToHome()&&this.$dialog.alert({message:'为了使用户可以先简单试用一下小程序的效果，每个账号初始会有一次试用机会，成功下单后(无论是否付款)试用结束，继而开启"每隔 30 天才可以使用一次"的限制',confirmButtonText:"我知道了"})},clickLastUseTime:function(){this.checkGoToHome()&&this.$dialog.alert({message:"为防止黄牛恶意使用这个小程序，每个账号隔 30 天才可以使用一次，成功下单后(无论是否付款)会消耗本次使用机会",confirmButtonText:"我知道了"})},selectQuestionAction:function(e){this.showQuestionAction=!1,this.$dialog.alert({message:e.answer,confirmButtonText:"我知道了"})},payAuthor:function(){this.$dialog.confirm({message:"本工具仅靠个人业余维护，租赁云服务器也有不小的花费，如果您不介意的话，能否慷慨解囊打赏一下作者，最后，衷心地地祝愿您的孩子早日康复！",confirmButtonText:"打赏一下",cancelButtonText:"残忍拒绝"}).then((function(){var e="alipayqr://platformapi/startapp?saId=10000007&clientVersion=3.7.0.0718&qrcode="+encodeURI("https://qr.alipay.com/fkx00506jxkfixll6sbpm30")+"%3F_s%3Dweb-other&_t="+(new Date).getTime();window.open(e)})).catch((function(){}))}}},x=I,O=Object(l["a"])(x,T,$,!1,null,"71151082",null),S=O.exports;o["default"].use(m["a"]);var C=new m["a"]({base:"/",routes:[{path:"/",name:"home",component:w},{path:"/user",name:"user",component:S}]}),A=s("2f62");o["default"].use(A["a"]);var P=s("c1df"),N=new Date,U=new A["a"].Store({state:{connected:!1,loginLoading:!1,departments:[],doctors:{},specs:{},user:{},userInfo:{},medCards:[],initedCount:5,departmentIndex:null===localStorage.getItem("departmentIndex")?0:Number(localStorage.getItem("departmentIndex")),outpatientTypeIndex:null===localStorage.getItem("outpatientTypeIndex")?0:Number(localStorage.getItem("outpatientTypeIndex")),today:N,selectedDate:P(N).format("YYYY-MM-DD"),items:[],loadedItems:!1,order:void 0},mutations:{setConnected:function(e,t){e.connected=t},setDepartments:function(e,t){e.departments=t,e.initedCount--},setDoctors:function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e.doctors[t[s].doctorCode]=t[s]);e.initedCount--},setUser:function(e,t){e.user=t},setSpecs:function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e.specs[t[s].specCode]=t[s]);e.initedCount--},setUserInfo:function(e,t){e.userInfo=t,e.initedCount--},setMedCards:function(e,t){e.medCards=t,e.initedCount--},setItems:function(e,t){e.items=t,e.loadedItems=!0},setOrder:function(e,t){e.order=t},resetInitedCount:function(e){e.initedCount=5},setLoginLoading:function(e,t){e.loginLoading=t},setDepartmentIndex:function(e,t){e.departmentIndex=t,localStorage.setItem("departmentIndex",t)},setOutpatientTypeIndex:function(e,t){e.outpatientTypeIndex=t,localStorage.setItem("outpatientTypeIndex",t)},setSelectedDate:function(e,t){e.selectedDate=t}},getters:{isConnected:function(e){return e.connected},getDepartments:function(e){return e.departments},getDoctors:function(e){return e.doctors},getUser:function(e){return e.user},getOs:function(e){var t=navigator.userAgent,s=/(?:Windows Phone)/.test(t),n=/(?:SymbianOS)/.test(t)||s,o=/(?:Android)/.test(t),r=/(?:Firefox)/.test(t),a=/(?:iPad|PlayBook)/.test(t)||o&&!/(?:Mobile)/.test(t)||r&&/(?:Tablet)/.test(t),i=/(?:iPhone)/.test(t)&&!a,c=!i&&!o&&!n;return{isTablet:a,isPhone:s||o||i,isAndroid:o,isPc:c,isAlipay:-1!==navigator.userAgent.toLowerCase().indexOf("alipay")}},getSpecs:function(e){return e.specs},getUserInfo:function(e){return e.userInfo},getMedCards:function(e){return e.medCards},getItems:function(e){return e.items},getOrder:function(e){return e.order},getInitedCount:function(e){return e.initedCount},getLoginLoading:function(e){return e.loginLoading},getDepartmentIndex:function(e){return e.departmentIndex},getOutpatientTypeIndex:function(e){return e.outpatientTypeIndex},getToday:function(e){return e.today},getSelectedDate:function(e){return e.selectedDate},getLoadedItems:function(e){return e.loadedItems}},actions:{setConnected:function(e,t){var s=e.commit;s("setConnected",t)},setDepartments:function(e,t){var s=e.commit;s("setDepartments",t)},setDoctors:function(e,t){var s=e.commit;s("setDoctors",t)},setUser:function(e,t){var s=e.commit;s("setUser",t)},setSpecs:function(e,t){var s=e.commit;s("setSpecs",t)},setItems:function(e,t){var s=e.commit;s("setItems",t)},setUserInfo:function(e,t){var s=e.commit;s("setUserInfo",t)},setMedCards:function(e,t){var s=e.commit;s("setMedCards",t)},setOrder:function(e,t){var s=e.commit;s("setOrder",t)},resetInitedCount:function(e){var t=e.commit;t("resetInitedCount")},setLoginLoading:function(e,t){var s=e.commit;s("setLoginLoading",t)},setDepartmentIndex:function(e,t){var s=e.commit;s("setDepartmentIndex",t)},setOutpatientTypeIndex:function(e,t){var s=e.commit;s("setOutpatientTypeIndex",t)},setSelectedDate:function(e,t){var s=e.commit;s("setSelectedDate",t)}}}),_=s("9483");Object(_["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var L=s("5132"),M=s.n(L),R=s("5c96"),q=s.n(R),B=(s("0fae"),s("b970"));s("157a");o["default"].use(B["a"]),o["default"].config.productionTip=!1,o["default"].use(q.a),U.getters.getOs.isAlipay&&o["default"].use(new M.a({debug:!0,connection:window.location.hostname+":29001",vuex:{store:U,actionPrefix:"SOCKET_",mutationPrefix:"SOCKET_"}})),new o["default"]({router:C,store:U,render:function(e){return e(g)},sockets:{connect:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,U.dispatch("setConnected",!0);case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),disconnect:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,U.dispatch("setConnected",!1);case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}}).$mount("#app")},"5c0b":function(e,t,s){"use strict";var n=s("e332"),o=s.n(n);o.a},e332:function(e,t,s){}});
//# sourceMappingURL=app.a1dbf5fa.js.map